import { _LogSource, _TraceLogger } from '@microsoft/sp-diagnostics';
import { SPHttpClient } from '@microsoft/sp-http';
var SPOSuiteNavDataSource = (function () {
    function SPOSuiteNavDataSource(httpClient, currentUICultureName, webServerRelativeUrl) {
        this.suiteNavService = 0 ;
        this._currentUICultureName = currentUICultureName;
        this._spHttpClient = httpClient;
        this._siteRelUrl = webServerRelativeUrl === '/' ? '' : webServerRelativeUrl;
    }
    SPOSuiteNavDataSource.prototype.loadData = function () {
        var url = this._siteRelUrl
            + '/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale='
            + this._currentUICultureName
            + '&v=2&mobilereq=0&msajax=1';
        return this._spHttpClient.post(url, SPHttpClient.configurations.v1, {})
            .then(function (response) {
            if (response.status !== 200 || response.headers.get('SharePointError')) {
                _TraceLogger.logVerbose(SPOSuiteNavDataSource._logSource, 'Failed to retrieve SPO SuiteNavData');
                return Promise.reject('Failed to retrieve SPO SuiteNavData');
            }
            return response.json().then(function (jsonResponse) {
                return jsonResponse;
            });
        });
    };
    SPOSuiteNavDataSource._logSource = _LogSource.create('SPOSuiteNavDataSource');
    return SPOSuiteNavDataSource;
}());
export default SPOSuiteNavDataSource;
