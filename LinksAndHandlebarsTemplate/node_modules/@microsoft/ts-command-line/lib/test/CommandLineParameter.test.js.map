{"version":3,"sources":["test/CommandLineParameter.test.ts"],"names":[],"mappings":"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","file":"CommandLineParameter.test.js","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n// See LICENSE in the project root for license information.\r\n\r\nimport * as colors from 'colors';\r\n\r\nimport { CommandLineAction } from '../CommandLineAction';\r\nimport { CommandLineParser } from '../CommandLineParser';\r\nimport { DynamicCommandLineParser } from '../DynamicCommandLineParser';\r\nimport { DynamicCommandLineAction } from '../DynamicCommandLineAction';\r\n\r\nfunction createParser(): DynamicCommandLineParser {\r\n  const commandLineParser: DynamicCommandLineParser = new DynamicCommandLineParser(\r\n    {\r\n      toolFilename: 'example',\r\n      toolDescription: 'An example project'\r\n    }\r\n  );\r\n  commandLineParser.defineFlagParameter({\r\n    parameterLongName: '--global-flag',\r\n    parameterShortName: '-g',\r\n    description: 'A flag that affects all actions'\r\n  });\r\n\r\n  const action: DynamicCommandLineAction = new DynamicCommandLineAction({\r\n    actionName: 'do-job',\r\n    summary: 'does the job',\r\n    documentation: 'a longer description'\r\n  });\r\n  commandLineParser.addAction(action);\r\n\r\n  action.defineChoiceParameter({\r\n    parameterLongName: '--choice-with-default',\r\n    description: 'A choice with a default',\r\n    alternatives: [ 'one', 'two' ],\r\n    defaultValue: 'one'\r\n  });\r\n  action.defineChoiceParameter({\r\n    parameterLongName: '--choice',\r\n    parameterShortName: '-c',\r\n    description: 'A choice without a default',\r\n    alternatives: [ 'one', 'two' ]\r\n  });\r\n  action.defineFlagParameter({\r\n    parameterLongName: '--flag',\r\n    parameterShortName: '-f',\r\n    description: 'A flag'\r\n  });\r\n  action.defineIntegerParameter({\r\n    parameterLongName: '--integer',\r\n    parameterShortName: '-i',\r\n    description: 'An integer',\r\n    argumentName: 'NUMBER'\r\n  });\r\n  action.defineStringParameter({\r\n    parameterLongName: '--string',\r\n    parameterShortName: '-s',\r\n    description: 'A string',\r\n    argumentName: 'TEXT'\r\n  });\r\n  action.defineStringListParameter({\r\n    parameterLongName: '--string-list',\r\n    parameterShortName: '-l',\r\n    description: 'A string list',\r\n    argumentName: 'LIST'\r\n  });\r\n  return commandLineParser;\r\n}\r\n\r\nfunction expectPropertiesToMatchSnapshot(object: {}, propertyNames: string[]): void {\r\n  const snapshotObject: {} = {};\r\n\r\n  for (const propertyName of propertyNames) {\r\n    snapshotObject[propertyName] = object[propertyName];\r\n  }\r\n  expect(snapshotObject).toMatchSnapshot();\r\n}\r\n\r\ndescribe('CommandLineParameter', () => {\r\n  it('prints the global help', () => {\r\n    const commandLineParser: CommandLineParser = createParser();\r\n    const helpText: string = colors.stripColors(commandLineParser.renderHelpText());\r\n    expect(helpText).toMatchSnapshot();\r\n  });\r\n\r\n  it('prints the action help', () => {\r\n    const commandLineParser: CommandLineParser = createParser();\r\n    const helpText: string = colors.stripColors(commandLineParser.getAction('do-job').renderHelpText());\r\n    expect(helpText).toMatchSnapshot();\r\n  });\r\n\r\n  it('parses an input with ALL parameters', () => {\r\n    const commandLineParser: CommandLineParser = createParser();\r\n    const action: CommandLineAction = commandLineParser.getAction('do-job');\r\n\r\n    const args: string[] = [ '-g',\r\n      'do-job', '-c', 'two', '-f', '-i', '123', '-s', 'hello', '-l', 'first', '-l', 'second'];\r\n\r\n    return commandLineParser.execute(args).then(() => {\r\n      expect(commandLineParser.selectedAction).toBe(action);\r\n\r\n      expectPropertiesToMatchSnapshot(\r\n        commandLineParser.getFlagParameter('--global-flag'),\r\n        ['description', 'kind', 'longName', 'shortName', 'value']\r\n      );\r\n\r\n      expectPropertiesToMatchSnapshot(\r\n        action.getChoiceParameter('--choice'),\r\n        ['alternatives', 'defaultValue', 'description', 'kind', 'longName', 'shortName', 'value']\r\n      );\r\n      expectPropertiesToMatchSnapshot(\r\n        action.getFlagParameter('--flag'),\r\n        ['description', 'kind', 'longName', 'shortName', 'value']\r\n      );\r\n      expectPropertiesToMatchSnapshot(\r\n        action.getIntegerParameter('--integer'),\r\n        ['argumentName', 'description', 'kind', 'longName', 'shortName', 'value']\r\n      );\r\n      expectPropertiesToMatchSnapshot(\r\n        action.getStringParameter('--string'),\r\n        ['argumentName', 'description', 'kind', 'longName', 'shortName', 'value']\r\n      );\r\n      expectPropertiesToMatchSnapshot(\r\n        action.getStringListParameter('--string-list'),\r\n        ['argumentName', 'description', 'kind', 'longName', 'shortName', 'values']\r\n      );\r\n    });\r\n  });\r\n\r\n  it('parses an input with NO parameters', () => {\r\n    const commandLineParser: CommandLineParser = createParser();\r\n    const action: CommandLineAction = commandLineParser.getAction('do-job');\r\n    const args: string[] = [ 'do-job'];\r\n\r\n    return commandLineParser.execute(args).then(() => {\r\n      expect(commandLineParser.selectedAction).toBe(action);\r\n\r\n      expectPropertiesToMatchSnapshot(\r\n        commandLineParser.getFlagParameter('--global-flag'),\r\n        ['description', 'kind', 'longName', 'shortName', 'value']\r\n      );\r\n\r\n      expectPropertiesToMatchSnapshot(\r\n        action.getChoiceParameter('--choice'),\r\n        ['alternatives', 'defaultValue', 'description', 'kind', 'longName', 'shortName', 'value']\r\n      );\r\n      expectPropertiesToMatchSnapshot(\r\n        action.getFlagParameter('--flag'),\r\n        ['description', 'kind', 'longName', 'shortName', 'value']\r\n      );\r\n      expectPropertiesToMatchSnapshot(\r\n        action.getIntegerParameter('--integer'),\r\n        ['argumentName', 'description', 'kind', 'longName', 'shortName', 'value']\r\n      );\r\n      expectPropertiesToMatchSnapshot(\r\n        action.getStringParameter('--string'),\r\n        ['argumentName', 'description', 'kind', 'longName', 'shortName', 'value']\r\n      );\r\n      expectPropertiesToMatchSnapshot(\r\n        action.getStringListParameter('--string-list'),\r\n        ['argumentName', 'description', 'kind', 'longName', 'shortName', 'values']\r\n      );\r\n    });\r\n  });\r\n});\r\n"],"sourceRoot":"../../../src"}