{"version":3,"sources":["webparts/featuredContentWebPart/components/FeaturedContentWebPart.tsx"],"names":[],"mappings":"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","file":"webparts/featuredContentWebPart/components/FeaturedContentWebPart.js","sourcesContent":["import * as React from 'react';\nimport { Panel, PanelType } from 'office-ui-fabric-react/lib/Panel';\nimport { Nav } from 'office-ui-fabric-react/lib/Nav';\nimport { DefaultButton, PrimaryButton } from 'office-ui-fabric-react/lib/Button';\nimport {\n  CommandButton,\n  IButtonProps\n} from 'office-ui-fabric-react/lib/Button';\nimport styles from './FeaturedContentWebPart.module.scss';\nimport * as strings from 'featuredContentWebPartStrings';\nimport { IFeaturedContentWebPartProps } from './IFeaturedContentWebPartProps';\nimport { IFeaturedContentState } from './IFeaturedContentState';\nimport FeaturedContentFactory from './layouts/FeaturedContentFactory';\nimport { LinkType } from \"../../../components/LinkPickerPanel/ILinkPickerPanelProps\";\nimport LinkPickerPanel from \"../../../components/LinkPickerPanel/LinkPickerPanel\";\nimport ElemUtil from \"../../../utilities/element/elemUtil\";\n\nconst urlField = \"URL\";\nconst imageField = \"Image\";\nconst descriptionField = \"Description\";\nconst openNewTabField = \"NewTab\";\nconst contentField = \"Content\";\n\nexport default class FeaturedContentWebPart extends React.Component<IFeaturedContentWebPartProps, IFeaturedContentState> {\n  constructor(){\n    super();\n  }\n\n  private _dragElement : any;\n  public get dragElement() : any {\n    return this._dragElement;\n  }\n  public set dragElement(v : any) {\n    this._dragElement = v;\n  }\n  \n  private _mouseTarget : any;\n  public get mouseTarget() : any {\n    return this._mouseTarget;\n  }\n  public set mouseTarget(v : any) {\n    this._mouseTarget = v;\n  }\n\n  public setTitle(event){\n    this.props.setTitle(event.target.value);\n  }\n\n  public addBox(event){\n    this.setState(\n      {\n        isLinkPanelOpen:false, \n        isSiteSelected: true, \n        linkValid:false,\n        linkEntered: \"\"          \n      }\n    );\n    this.props.editItem(-1);\n  }\n\n  public editBox(event){\n    event.stopPropagation();\n    event.preventDefault();\n    this.props.editItem(ElemUtil.closest(event.target,'[data-index]').getAttribute(\"data-index\"));\n    return false;\n  }\n\n  public deleteBox(event){\n    event.stopPropagation();\n    event.preventDefault();\n    if(confirm(strings.DeleteItemConfirmMessage))\n      this.props.deleteItem(ElemUtil.closest(event.target,'[data-index]').getAttribute(\"data-index\"));\n    return false;\n  }\n\n  public mouseDragDown(event){\n    this.mouseTarget = event.target;\n  }\n\n  public startDrag(event){\n    event.stopPropagation();\n    if(event.currentTarget.querySelector('#drag-handle').contains(this.mouseTarget)){\n      this.dragElement = event.currentTarget;\n      event.dataTransfer.eventAllowed=\"move\";\n      event.dataTransfer.setData('text/plan','drag-handle');\n    }\n    else{\n      event.preventDefault();\n    }\n  }\n\n  public isbefore(a, b) {\n    if (a.parentNode == b.parentNode) {\n      for (var cur = a; cur; cur = cur.previousSibling) {\n        if (cur === b) { \n          return true;\n        }\n      }\n    }\n    return false;\n  } \n\n  public endDrag(event){\n    const indexArr:number[] = [];\n    const currentElements = ElemUtil.closest(event.currentTarget,'[data-reactroot]').querySelectorAll('[data-index]');\n    currentElements.forEach((element)=>{indexArr.push(parseInt(element.getAttribute('data-index')));});\n    this.props.rearrangeItems(indexArr);\n  }\n\n  public moveItem(event){\n    if (this.isbefore(this.dragElement, ElemUtil.closest(event.target,'[data-index]'))) {\n      ElemUtil.closest(event.target,'[data-index]').parentNode.insertBefore(this.dragElement, ElemUtil.closest(event.target,'[data-index]'));\n    }\n    else {\n      if(!this.dragElement.contains(ElemUtil.closest(event.target,'[data-index]')))\n        ElemUtil.closest(event.target,'[data-index]').parentNode.insertBefore(this.dragElement, ElemUtil.closest(event.target,'[data-index]').nextSibling);\n    }\n  }\n\n  public render(): React.ReactElement<IFeaturedContentWebPartProps> {\n    return this.props.usesListMode ? this.renderAdvancedWebPart() : this.renderBasicWebPart();\n  }\n\n  private linkPickerPanel: LinkPickerPanel;\n\n  public openLinkPicker(event){\n    this.linkPickerPanel.pickLink().then(({name, url}) => {\n      this.props.setUrl(url, name);\n    });\n  }\n\n  public createNewItemFromLink(event){\n    this.props.resetActiveIndex();\n    this.openLinkPicker(event);\n  }\n\n  public renderBasicWebPart():JSX.Element{\n    return (\n      <div>\n        <div className={styles[\"webpart-header\"]}>\n          { this.props.isEdit && <textarea onChange={this.setTitle.bind(this)} className={styles[\"edit\"]} placeholder={strings.TitlePlaceholder} aria-label=\"Add a title\">{this.props.title}</textarea> }\n          { !this.props.isEdit && this.props.title && <span className={styles[\"view\"]}>{this.props.title}</span> }          \n        </div>\n        { this.props.isEdit &&\n          <CommandButton className={styles[\"new-item\"]} icon='Add' onClick={this.addBox.bind(this)}>{strings.AddNewButtonText}</CommandButton>\n         }\n        { FeaturedContentFactory.getLayout(this.props.layoutMode,false,this).render(this.props.featuredContentItems,this.props.isEdit) }\n        { this.props.isEdit &&\n          <LinkPickerPanel\n            webPartContext={this.props.context}\n            className={styles[\"link-picker\"]}\n            webAbsUrl={this.props.context.pageContext.web.absoluteUrl}\n            linkType={ LinkType.any }\n            ref={ (ref) => { this.linkPickerPanel = ref; } } />\n        }\n      </div>\n    );\n  }\n\n  public renderAdvancedWebPart():JSX.Element{\n    return (\n      <div>\n        <div className={styles[\"webpart-header\"]}>\n          { this.props.isEdit && <textarea onChange={this.setTitle.bind(this)} className={styles[\"edit\"]} placeholder={strings.TitlePlaceholder} aria-label=\"Add a title\">{this.props.title}</textarea> }\n          { !this.props.isEdit && this.props.title && <span className={styles[\"view\"]}>{this.props.title}</span> }          \n        </div>\n        { FeaturedContentFactory.getLayout(this.props.layoutMode,true,this).render(this.props.links,this.props.isEdit) }\n      </div>\n    );\n  }\n}\n"],"sourceRoot":"..\\..\\..\\..\\src"}