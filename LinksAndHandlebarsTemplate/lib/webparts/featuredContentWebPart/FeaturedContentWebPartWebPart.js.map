{"version":3,"sources":["webparts/featuredContentWebPart/FeaturedContentWebPartWebPart.ts"],"names":[],"mappings":"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","file":"webparts/featuredContentWebPart/FeaturedContentWebPartWebPart.js","sourcesContent":["import * as React from 'react';\nimport * as ReactDom from 'react-dom';\nimport { Version, DisplayMode } from '@microsoft/sp-core-library';\nimport {\n  BaseClientSideWebPart,\n  IPropertyPaneConfiguration,\n  PropertyPaneButton,\n  PropertyPaneButtonType,\n  PropertyPaneCheckbox,\n  PropertyPaneChoiceGroup,\n  PropertyPaneLabel,\n  PropertyPaneLink,\n  PropertyPaneTextField,\n  PropertyPaneToggle\n} from '@microsoft/sp-webpart-base';\nimport { SPComponentLoader } from '@microsoft/sp-loader';\nimport * as strings from 'featuredContentWebPartStrings';\nimport FeaturedContentWebPart from './components/FeaturedContentWebPart';\nimport { IFeaturedItem } from './components/IFeaturedItem';\nimport { IFeaturedContentWebPartProps } from './components/IFeaturedContentWebPartProps';\nimport { IFeaturedContentWebPartWebPartProps } from './IFeaturedContentWebPartWebPartProps';\nimport { FeaturedContentLayout } from './components/layouts/FeatureContentLayout';\nimport { PropertyFieldCamlQueryFieldMapping, SPFieldType, SPFieldRequiredLevel, PropertyFieldCamlQueryOrderBy } from '../../propertyPane/propertyFieldCamlQueryFieldMapping/PropertyFieldCamlQueryFieldMapping';\nimport pnp from 'sp-pnp-js';\nimport { PropertyPaneImageSelector, ImageDisplayType } from \"../../propertyPane/propertyFieldImageSelector/PropertyFieldImageSelector\";\nimport QueryStringParser from \"../../utilities/urlparser/queryStringParser\";\n\nconst urlField = \"URL\";\nconst imageField = \"Image\";\nconst descriptionField = \"Description\";\nconst openNewTabField = \"NewTab\";\nconst contentField = \"Content\";\n\nexport default class FeaturedContentWebPartWebPart extends BaseClientSideWebPart<IFeaturedContentWebPartWebPartProps> {\n\n  constructor(){\n    super();\n    this.onPropertyPaneFieldChanged = this.onPropertyPaneFieldChanged.bind(this);\n    if(document.querySelectorAll(\"link[href*='bootstrap.min.css']\").length===0){\n      SPComponentLoader.loadCss('https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css');\n    }\n  }\n\n  public onInit(): Promise<void> {\n    return super.onInit().then(_ => {\n      pnp.setup({\n        spfxContext: this.context\n      });\n    });\n  }\n\n  private _webpart : any;\n  public get webpart() : any {\n    return this._webpart;\n  }\n  public set webpart(v : any) {\n    this._webpart = v;\n  } \n\n  private _activeIndex : number = -1;\n  public get activeIndex() : number {\n    return this._activeIndex;\n  }\n  public set activeIndex(v : number) {\n    this._activeIndex = v;\n  }\n\n  public render(): void {\n    this.properties.featuredContentItems.forEach(element => {\n      if(element.Content===undefined){\n        element.Content = \"\";\n      }\n      if(element.ImageMode===undefined){\n        element.ImageMode=ImageDisplayType.Auto;\n      }\n    });\n\n    const element: React.ReactElement<IFeaturedContentWebPartProps> = React.createElement(\n      FeaturedContentWebPart,\n      {\n        featuredContentItems: this.properties.featuredContentItems,\n        title: this.properties.title,\n        isEdit: this.displayMode===DisplayMode.Edit,\n        layoutMode: this.properties.layoutMode,\n        usesListMode: this.properties.usesListMode,\n        advancedCamlData: this.properties.advancedCamlData,\n        advancedCamlQuery: this.properties.advancedCamlQuery,\n        links: [],\n        context: this.context,\n        setTitle: this.setTitle.bind(this),\n        setUrl: this.setUrl.bind(this),\n        editItem: this.editBasicItem.bind(this),\n        deleteItem: this.deleteBasicItem.bind(this),\n        rearrangeItems: this.rearrangeBasicItems.bind(this),\n        resetActiveIndex: this.resetIndex.bind(this)\n      }\n    );\n\n    if(this.properties.usesListMode){\n      const propData = this.properties.advancedCamlData ? JSON.parse(this.properties.advancedCamlData) : {fieldMappings:[], selectedList:{}};\n      if(propData.selectedList.id){\n        pnp.sp.web.lists.getById(propData.selectedList.id).getItemsByCAMLQuery({ ViewXml: QueryStringParser.ReplaceQueryStringParameters(this.properties.advancedCamlQuery)}).then((response:any[])=>{\n          response.forEach(value => {\n          var link = {};\n          propData.fieldMappings.forEach(mapping => {\n            switch(mapping.type){\n              case SPFieldType.URL:\n                link[mapping.name] = value[mapping.mappedTo] ? value[mapping.mappedTo][\"Url\"] : null;\n                link[mapping.name+\"_text\"] = value[mapping.mappedTo] ? value[mapping.mappedTo][\"Description\"] : null;\n                break;\n              default: \n                link[mapping.name] = value[mapping.mappedTo];\n                break;\n              }\n            });\n            \n            if(link[urlField] !== null)\n              element.props.links.push(link);\n          });\n          this.webpart = ReactDom.render(element, this.domElement);\n        }).catch((error)=>{ });\n      }\n    }\n    else\n      this.webpart = ReactDom.render(element, this.domElement);\n  }\n\n  protected get dataVersion(): Version {\n    return Version.parse('1.0');\n  }\n\n  public openLinkSelector(event){\n    this.webpart.openLinkPicker(event);\n  }\n\n  public itemValidation(length: number, required: boolean, errorText: string, value: string): Promise<string> {\n    return new Promise<string>((resolve: (validationMessage: string)=>void)=>{\n      if(value.length>length){\n        resolve(errorText);\n      }\n      else if(required && value.length<1){\n        resolve(strings.RequiredValueErrorText);\n      }\n      else{\n        resolve(\"\");\n      }\n    });\n  }\n\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\n    if(this.context.propertyPane.isRenderedByWebPart()) return this.getEditItemPropertyPane();\n    return this.getWebPartPropertyPane();\n  }\n\n  public getWebPartPropertyPane(): IPropertyPaneConfiguration{\n    return {\n      pages: [\n        {\n          header: {\n            description: ''\n          },\n          groups:[\n            {\n              groupName: strings.LayoutLabel,\n              groupFields: [\n                PropertyPaneChoiceGroup(\"layoutMode\",{\n                  label: strings.LayoutSelectorLabel,\n                  options:[\n                    {\n                      checked: this.properties.layoutMode===FeaturedContentLayout.HorizontalTitleOnly,\n                      key: FeaturedContentLayout.HorizontalTitleOnly,\n                      imageSrc: \"https://thehubcdnvz.azureedge.net/hub-web-parts/fc-Layout-Image-Title.svg\",\n                      selectedImageSrc: \"https://thehubcdnvz.azureedge.net/hub-web-parts/fc-Layout-Image-Title.svg\",\n                      imageSize: { height:32,width:32 },\n                      text: strings.TitleOnlyLabel\n                    },\n                    {\n                      checked: this.properties.layoutMode===FeaturedContentLayout.HorizontalTitleAndDescription,\n                      key: FeaturedContentLayout.HorizontalTitleAndDescription,\n                      imageSrc: \"https://thehubcdnvz.azureedge.net/hub-web-parts/fc-Layout-Title-Description.svg\",\n                      imageSize: { height:32,width:32 },\n                      selectedImageSrc: \"https://thehubcdnvz.azureedge.net/hub-web-parts/fc-Layout-Title-Description.svg\",\n                      text: strings.TitleDescriptionLabel\n                    },\n                    {\n                      checked: this.properties.layoutMode===FeaturedContentLayout.Vertical,\n                      key: FeaturedContentLayout.Vertical,\n                      imageSrc: \"https://thehubcdnvz.azureedge.net/hub-web-parts/fc-Layout-Stacked.svg\",\n                      imageSize: { height:32,width:32 },\n                      selectedImageSrc: \"https://thehubcdnvz.azureedge.net/hub-web-parts/fc-Layout-Stacked.svg\",\n                      text: strings.StackedLabel\n                    },\n                    {\n                      checked: this.properties.layoutMode===FeaturedContentLayout.VerticalAlternating,\n                      key: FeaturedContentLayout.VerticalAlternating,\n                      imageSrc: \"https://thehubcdnvz.azureedge.net/hub-web-parts/fc-Layout-Alt-Stacked.svg\",\n                      imageSize: { height:32,width:32 },\n                      selectedImageSrc: \"https://thehubcdnvz.azureedge.net/hub-web-parts/fc-Layout-Alt-Stacked.svg\",\n                      text: strings.AltStackedLabel\n                    }\n                  ]\n                })\n              ]\n            },\n            {\n              groupName: strings.AdvancedListModeGroupLabel,\n              isCollapsed:!this.properties.usesListMode,\n              groupFields:[\n                PropertyPaneToggle('usesListMode',{\n                  label: strings.AdvancedEnableListModeLabel,\n                  onText: strings.OnLabel,\n                  offText: strings.OffLabel\n                }),\n                PropertyPaneLabel('listModeInfo',{\n                  text: strings.AdvancedEnableListModeInfo\n                }),\n                PropertyFieldCamlQueryFieldMapping('advancedCamlQuery',{\n                  label: \"\",\n                  dataPropertyPath: 'advancedCamlData',\n                  query: this.properties.advancedCamlQuery,\n                  fieldMappings: [\n                    { name: urlField,type: SPFieldType.URL, requiredLevel: SPFieldRequiredLevel.Required },\n                    { name: imageField, type: SPFieldType.URL, requiredLevel: SPFieldRequiredLevel.Required },\n                    { name: descriptionField, type: SPFieldType.Text, requiredLevel: SPFieldRequiredLevel.Required },\n                    { name: contentField, type: SPFieldType.Text, requiredLevel: SPFieldRequiredLevel.Required },\n                    { name: openNewTabField, type: SPFieldType.Boolean, requiredLevel: SPFieldRequiredLevel.Required }\n                  ],\n                  createFields:[\n                    '<Field ID=\"{c29e077d-f466-4d8e-8bbe-72b66c5f205c}\" Name=\"URL\" SourceID=\"http://schemas.microsoft.com/sharepoint/v3\" StaticName=\"URL\" Group=\"Base Columns\" Type=\"URL\" DisplayName=\"URL\" Required=\"TRUE\"/>',\n                    '<Field Type=\"Text\" DisplayName=\"Description\" Required=\"FALSE\" EnforceUniqueValues=\"FALSE\" Indexed=\"FALSE\" MaxLength=\"255\" Group=\"Web Part Columns\" ID=\"{6df0c033-e0f6-4801-aa83-b7a5bb80f0f4}\" SourceID=\"{a5df0f33-264b-4bf8-a651-222fcdf5d32d}\" StaticName=\"Description\" Name=\"Description\" Version=\"5\" />',\n                    '<Field Type=\"Note\" DisplayName=\"Content\" Required=\"FALSE\" EnforceUniqueValues=\"FALSE\" Indexed=\"FALSE\" NumLines=\"6\" RichText=\"TRUE\" RichTextMode=\"FullHtml\" IsolateStyles=\"TRUE\" Sortable=\"FALSE\" ID=\"{24f71f35-b1ad-43dc-8ad7-56faddad0870}\" SourceID=\"{11fc90a7-6fab-44ff-87ca-f7ac20b3bc50}\" StaticName=\"Content\" Name=\"Content\" ColName=\"ntext2\" RowOrdinal=\"0\" Version=\"1\" />',\n                    '<Field Type=\"Number\" DisplayName=\"SortOrder\" Required=\"FALSE\" EnforceUniqueValues=\"FALSE\" Indexed=\"FALSE\" Group=\"Web Part Columns\" ID=\"{7a911a9e-dbe1-4a87-bd40-c042db929a80}\" SourceID=\"{a5df0f41-264b-4bf8-a651-222fcdf5d32d}\" StaticName=\"SortOrder\" Name=\"SortOrder\" Version=\"5\" />',\n                    '<Field Type=\"URL\" DisplayName=\"Image\" Required=\"FALSE\" EnforceUniqueValues=\"FALSE\" Indexed=\"FALSE\" Group=\"Web Part Columns\" ID=\"{f9ba1903-e722-42cd-843e-f898d4c1fcb4}\" SourceID=\"{f9ba1903-e722-42cd-843e-f898d4c1fcb4}\" StaticName=\"Image\" Name=\"Image\" Version=\"5\" />',\n                    '<Field Type=\"Boolean\" DisplayName=\"OpenLinkinNewTab\" Required=\"FALSE\" EnforceUniqueValues=\"FALSE\" Indexed=\"FALSE\" Group=\"Web Part Columns\" ID=\"{4bf7c60f-0737-49c9-894c-6a31af134242}\" SourceID=\"{4bf7c60f-0737-49c9-894c-6a31af134242}\" StaticName=\"OpenLinkInNewTab\" Name=\"OpenLinkInNewTab\" Version=\"5\" />'\n                  ],\n                  createTitleRequired:false,\n                  includeHidden: false,\n                  orderBy: PropertyFieldCamlQueryOrderBy.Title,\n                  showOrderBy: true,\n                  showFilters: true,\n                  showMax:false,\n                  showCreate:true,\n                  render: this.render.bind(this),\n                  onPropertyChange: this.onPropertyPaneFieldChanged.bind(this),\n                  context: this.context,\n                  properties: this.properties,\n                  disabled: !this.properties.usesListMode,\n                  onGetErrorMessage: null,\n                  deferredValidationTime: 0,\n                  key: 'spListQueryFieldId'\n                })\n              ]\n            }\n          ],\n          displayGroupsAsAccordion: true            \n        }\n      ]\n    };\n  }\n\n  public getEditItemPropertyPane(): IPropertyPaneConfiguration{\n    return {\n      pages: [\n        {\n          header: {\n            description: \"\"\n          },\n          displayGroupsAsAccordion:true,\n          groups: [\n            {\n              groupName: strings.EditItemGeneralLabel,\n              groupFields:[\n                PropertyPaneTextField(\"featuredContentItems[\"+this.activeIndex+\"].Title\",{\n                  label: strings.EditItemGeneralTitleLabel,\n                  description: strings.EditItemGeneralTitlePreCountLabel+(80-this.properties.featuredContentItems[this.activeIndex].Title.length)+strings.EditItemGeneralTitlePostCountLabel,\n                  onGetErrorMessage: this.itemValidation.bind(this, 80, true, strings.EditItemGeneralTitleErrorText)\n                }),\n                PropertyPaneTextField(\"featuredContentItems[\"+this.activeIndex+\"].Description\",{\n                  label: strings.EditItemGeneralDescriptionLabel,\n                  description: strings.EditItemGeneralDescriptionPreCountLabel+(130-(this.properties.featuredContentItems[this.activeIndex].Description ? this.properties.featuredContentItems[this.activeIndex].Description.length : 0))+strings.EditItemGeneralDescriptionPostCountLabel,\n                  onGetErrorMessage: this.itemValidation.bind(this, 130, false, strings.EditItemGeneralDescriptionErrorText)\n                }),\n                PropertyPaneTextField(\"featuredContentItems[\"+this.activeIndex+\"].Content\",{\n                    label: strings.EditItemGeneralContentLabel,\n                    multiline:true\n                  }),\n                PropertyPaneLabel(\"itemLinkLabel\",{\n                  text: strings.EditItemGeneralSelectLinkLabel\n                }),\n                PropertyPaneLink(\"featuredContentItems[\"+this.activeIndex+\"].URL\",{\n                  target: \"_blank\",\n                  href: this.properties.featuredContentItems[this.activeIndex].URL,\n                  text: this.properties.featuredContentItems[this.activeIndex].URL\n                }),\n                PropertyPaneButton(\"itemChangeLink\",{\n                  text: strings.EditItemGeneralSelectLinkButtonText,\n                  buttonType: PropertyPaneButtonType.Primary,\n                  onClick: this.openLinkSelector.bind(this)\n                }),\n                PropertyPaneCheckbox(\"featuredContentItems[\"+this.activeIndex+\"].NewTab\",{\n                  text:strings.EditItemGeneralOpenTabLabel\n                })\n              ]\n            },\n            {\n              groupName: strings.EditItemImageLabel,\n              groupFields:[\n                PropertyPaneImageSelector(\"featuredContentItems[\"+this.activeIndex+\"].Image\",{\n                  label: strings.EditItemImageEntryLabel,\n                  properties: this.properties,\n                  context: this.context,\n                  changeImage: (url: string, name?: string)=>{\n                    const oldMode = this.properties.featuredContentItems[this.activeIndex].ImageMode;\n                    const oldUrl = this.properties.featuredContentItems[this.activeIndex].CustomImageUrl;\n                    const oldImage = this.properties.featuredContentItems[this.activeIndex].Image;\n                    const newUrl = url.indexOf(this.context.pageContext.web.absoluteUrl) > -1 ? this.context.pageContext.web.absoluteUrl+\"/_layouts/15/getpreview.ashx?resolution=0&clientMode=modernWebPart&path=\"+url : url;\n                    this.properties.featuredContentItems[this.activeIndex].CustomImageUrl = newUrl;\n                    this.properties.featuredContentItems[this.activeIndex].Image = newUrl;\n                    this.properties.featuredContentItems[this.activeIndex].ImageMode = ImageDisplayType.Custom;\n                    if(name){\n                      const oldAlt = this.properties.featuredContentItems[this.activeIndex].ImageAlternate;\n                      this.properties.featuredContentItems[this.activeIndex].ImageAlternate = name;\n                    this.onPropertyPaneFieldChanged(\"featuredContentItems[\"+this.activeIndex+\"].ImageAlternate\",oldAlt,name);\n                    }\n                    this.onPropertyPaneFieldChanged(\"featuredContentItems[\"+this.activeIndex+\"].ImageMode\",oldMode,ImageDisplayType.Custom);\n                    this.onPropertyPaneFieldChanged(\"featuredContentItems[\"+this.activeIndex+\"].Image\",oldImage,newUrl);\n                    this.onPropertyPaneFieldChanged(\"featuredContentItems[\"+this.activeIndex+\"].CustomImageUrl\",oldUrl,newUrl);\n\n                    this.render();\n                    this.context.propertyPane.refresh();\n                  },\n                  changeImageMode: (mode: ImageDisplayType)=>{\n                    const oldMode = this.properties.featuredContentItems[this.activeIndex].ImageMode;\n                    const oldImage = this.properties.featuredContentItems[this.activeIndex].Image;\n\n                    this.properties.featuredContentItems[this.activeIndex].ImageMode = mode;\n                    this.properties.featuredContentItems[this.activeIndex].Image = mode==ImageDisplayType.Auto ? \n                    this.properties.featuredContentItems[this.activeIndex].PreviewImageUrl:\n                    this.properties.featuredContentItems[this.activeIndex].CustomImageUrl;\n                    this.onPropertyPaneFieldChanged(\"featuredContentItems[\"+this.activeIndex+\"].ImageMode\",oldMode,mode);\n                    this.onPropertyPaneFieldChanged(\"featuredContentItems[\"+this.activeIndex+\"].Image\",oldImage,this.properties.featuredContentItems[this.activeIndex].Image);\n                    this.render();\n                    this.context.propertyPane.refresh();\n                  },\n                  imageMode: this.properties.featuredContentItems[this.activeIndex].ImageMode,\n                  key: \"imageSelector\"\n                }),\n                PropertyPaneTextField(\"featuredContentItems[\"+this.activeIndex+\"].ImageAlternate\",{\n                  label: strings.EditItemGeneralAlternateLabel,\n                  description: strings.EditItemGeneralDescriptionPreCountLabel+(130-(this.properties.featuredContentItems[this.activeIndex].ImageAlternate ? this.properties.featuredContentItems[this.activeIndex].ImageAlternate.length : 0))+strings.EditItemGeneralDescriptionPostCountLabel,\n                  onGetErrorMessage: this.itemValidation.bind(this, 130, false, strings.EditItemGeneralDescriptionErrorText)\n                })\n              ]\n            }\n          ]\n        }\n      ]\n    };\n  }\n\n  private rearrangeBasicItems(newOrder: number[]){\n    const currArr = this.properties.featuredContentItems;\n    const newArr = new Array<IFeaturedItem>();\n    for(var num in newOrder)\n      newArr.push(this.properties.featuredContentItems[newOrder[num]]);\n    this.properties.featuredContentItems.length=0;\n    for(var val in newArr)\n      this.properties.featuredContentItems.push(newArr[val]);\n    this.render();\n  }\n\n  private editBasicItem(index: number): void{\n    if(index===-1){\n      this.properties.featuredContentItems.push({\n        Title: strings.TitlePlaceholder,\n        URL: \"\",\n        NewTab: false,\n        Image: \"\",\n        Description:\"\",\n        Content: \"\",\n        ImageAlternate:\"\",\n        CustomImageUrl: \"\",\n        ImageMode: ImageDisplayType.Auto,\n        PreviewImageUrl: \"\"\n      });\n      index = this.properties.featuredContentItems.length-1;\n    }          \n    this.activeIndex = index;\n    this.context.propertyPane.open();\n  }\n\n  private deleteBasicItem(index: number): void{\n    this.properties.featuredContentItems.splice(index,1);\n    this.render();\n  }\n\n  //Function to validate previewUrl before setting Image property of item.\n  private checkImage(imageSrc, success, failure) {\n      var img = new Image();\n      img.onload = success; \n      img.onerror = failure;\n      img.src = imageSrc;\n  }\n\n  private setUrl(urlString: string, name?: string): void{\n    if(this.activeIndex===-1){\n      this.properties.featuredContentItems.push({\n        Title: strings.TitlePlaceholder,\n        Description:\"\",\n        Content: \"\",\n        URL: \"\",\n        NewTab: false,\n        Image:\"\",\n        ImageAlternate:\"\", \n        CustomImageUrl: \"\", \n        ImageMode: ImageDisplayType.Auto, \n        PreviewImageUrl: \"\" \n      });\n      this.activeIndex = this.properties.featuredContentItems.length-1;\n    }\n\n    var isDoc = false;\n    const docExtensions = [\"pdf\", \"xls\", \"xlsx\", \"doc\", \"docx\", \"ppt\", \"pptx\", \"pptm\", \"dot\"];\n    for(var i in docExtensions){\n      if(urlString.indexOf(docExtensions[i], urlString.length - docExtensions[i].length) !== -1)\n        isDoc = true;\n    }\n\n    this.properties.featuredContentItems[this.activeIndex].URL=urlString+( isDoc ? \"?web=1\" : \"\");\n    this.properties.featuredContentItems[this.activeIndex].Title=name ? name : this.properties.featuredContentItems[this.activeIndex].Title;\n    \n    //If image is on host server\n    var url = new URL(urlString);\n    if(url.host === window.location.host){\n      //Generate preview urlString\n      var tmpPreviewUrl = urlString.indexOf(\"getpreview.ashx\")>-1?urlString:this.context.pageContext.web.serverRelativeUrl+\"/_layouts/15/getpreview.ashx?resolution=0&clientMode=modernWebPart&path=\"+encodeURIComponent(urlString);\n      //Validate its an image\n      this.checkImage(tmpPreviewUrl, () => {\n        //Success function, set Image to preview urlString unless user has already set a custom image.\n        this.properties.featuredContentItems[this.activeIndex].PreviewImageUrl = tmpPreviewUrl;\n        this.properties.featuredContentItems[this.activeIndex].CustomImageUrl = tmpPreviewUrl;\n        if(this.properties.featuredContentItems[this.activeIndex].ImageMode==ImageDisplayType.Auto){\n          this.properties.featuredContentItems[this.activeIndex].Image = tmpPreviewUrl;\n        }\n        else{\n          //if image isn't already set, reset to preview urlString\n          if(!this.properties.featuredContentItems[this.activeIndex].Image)\n            this.properties.featuredContentItems[this.activeIndex].Image = tmpPreviewUrl;\n        }\n        this.context.propertyPane.refresh();\n        //Force UI to display new image.\n        this.render();\n      }, () => {\n        this.properties.featuredContentItems[this.activeIndex].PreviewImageUrl = \"\";\n        this.properties.featuredContentItems[this.activeIndex].CustomImageUrl = \"\";\n        this.properties.featuredContentItems[this.activeIndex].Image = \"\";\n        this.context.propertyPane.refresh();\n      });//Failure function -- reset images to blank in case of link change\n    }else{\n      //Image is external URL\n      this.checkImage(urlString, () => {\n        this.properties.featuredContentItems[this.activeIndex].PreviewImageUrl = encodeURI(urlString);\n        this.properties.featuredContentItems[this.activeIndex].CustomImageUrl = encodeURI(urlString);\n        this.properties.featuredContentItems[this.activeIndex].Image = encodeURI(urlString);\n        this.context.propertyPane.refresh();\n      },() => {\n        this.properties.featuredContentItems[this.activeIndex].PreviewImageUrl = \"\";\n        this.properties.featuredContentItems[this.activeIndex].CustomImageUrl = \"\";\n        this.properties.featuredContentItems[this.activeIndex].Image = \"\";\n        this.context.propertyPane.refresh();\n      });\n    }\n\n    if(!this.propertyPaneRenderedByWebPart)\n      this.context.propertyPane.open();\n    this.context.propertyPane.refresh();\n  }\n\n  private setTitle(title: string): void{\n    this.properties.title=title;\n  }\n\n  private resetIndex(): void{\n    this.activeIndex = -1;\n  }\n\n  private onContentChange(content: string): void{\n    const initVal = this.properties.featuredContentItems[this.activeIndex].Content;\n    this.properties.featuredContentItems[this.activeIndex].Content = content;\n    this.onPropertyPaneFieldChanged(\"featuredContentItems[\"+this.activeIndex+\"].Content\",initVal, content);\n    this.render();\n  }\n}"],"sourceRoot":"..\\..\\..\\src"}