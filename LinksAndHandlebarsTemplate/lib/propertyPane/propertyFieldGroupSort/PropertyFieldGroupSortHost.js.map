{"version":3,"sources":["propertyPane/propertyFieldGroupSort/PropertyFieldGroupSortHost.tsx"],"names":[],"mappings":"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","file":"PropertyFieldGroupSortHost.js","sourcesContent":["import * as React from 'react';\nimport { FormEvent } from 'react';\n\nimport { IPropertyFieldGroupSortPropsInternal } from './PropertyFieldGroupSort';\nimport { Label } from 'office-ui-fabric-react/lib/Label';\nimport { Async } from 'office-ui-fabric-react/lib/Utilities';\nimport { CommandButton } from 'office-ui-fabric-react/lib/Button';\n\nimport styles from '../PropertyFields.module.scss';\n\nexport interface IPropertyFieldGroupSortHostProps extends IPropertyFieldGroupSortPropsInternal{}\nexport interface IPropertyFieldGroupSortState{\n    currentValue?: string[];\n    errorMessage?: string;\n    selectedIndex?: number;\n}\n\nexport default class PropertyFieldGroupSortHost extends React.Component<IPropertyFieldGroupSortHostProps, IPropertyFieldGroupSortState> {\n    private latestValidateValue: string[];\n    private async: Async;\n    private delayedValidate: (value: string[]) => void;\n\n    public constructor(props: IPropertyFieldGroupSortHostProps){\n        super(props);\n\n        this.async = new Async(this);\n        this.state = ({ errorMessage: '', currentValue: this.props.initialValue} as IPropertyFieldGroupSortState);\n\n        this.onValueChanged = this.onValueChanged.bind(this);\n        this.validate = this.validate.bind(this);\n        this.notifyAfterValidate = this.notifyAfterValidate.bind(this);\n        this.delayedValidate = this.async.debounce(this.validate, this.props.deferredValidationTime);\n    }\n\n    private onValueChanged(newValue: any): void {\n        this.setState({currentValue: newValue});\n        this.delayedValidate(newValue);\n    }\n\n    private validate(value: string[]): void {\n        if (this.props.onGetErrorMessage === null || this.props.onGetErrorMessage === undefined) {\n            this.notifyAfterValidate(this.props.initialValue, value);\n            return;\n        }\n\n        if (this.latestValidateValue === value)\n        return;\n        this.latestValidateValue = value;\n\n        var result: string | PromiseLike<string> = this.props.onGetErrorMessage(value.join(',') || '');\n        if (result !== undefined) {\n        if (typeof result === 'string') {\n            if (result === undefined || result === '')\n            this.notifyAfterValidate(this.props.initialValue, value);\n            this.setState({ errorMessage: result} as IPropertyFieldGroupSortState);\n        }\n        else {\n            result.then((errorMessage: string) => {\n            if (errorMessage === undefined || errorMessage === '')\n                this.notifyAfterValidate(this.props.initialValue, value);\n            this.setState({ errorMessage } as IPropertyFieldGroupSortState);\n            });\n        }\n        }\n        else {\n        this.notifyAfterValidate(this.props.initialValue, value);\n        }\n    }\n\n    private notifyAfterValidate(oldValue: string[], newValue: string[]) {\n        this.props.properties[this.props.targetProperty] = newValue;\n        this.props.onPropertyChange(this.props.targetProperty, oldValue, newValue);\n        if (!this.props.disableReactivePropertyChanges && this.props.render != null)\n            this.props.render();\n    }\n\n    public componentWillUnmount() {\n        this.async.dispose();\n    }\n\n    private setSelectItem(index: number){\n        this.setState({selectedIndex: index});\n    }\n\n    private moveUp() {\n        if(this.state.selectedIndex != undefined && this.state.selectedIndex > 0){\n            var cloneValue = JSON.parse(JSON.stringify(this.state.currentValue));\n            var tmp = cloneValue[this.state.selectedIndex];\n            cloneValue[this.state.selectedIndex] = cloneValue[this.state.selectedIndex - 1];\n            cloneValue[this.state.selectedIndex - 1] = tmp;\n            this.setState({selectedIndex: this.state.selectedIndex -1});\n            this.onValueChanged(cloneValue);\n        }\n    }\n\n    private moveDown() {\n        if(this.state.selectedIndex != undefined && this.state.selectedIndex < this.state.currentValue.length - 1){\n            var cloneValue = JSON.parse(JSON.stringify(this.state.currentValue));\n            var tmp = cloneValue[this.state.selectedIndex];\n            cloneValue[this.state.selectedIndex] = cloneValue[this.state.selectedIndex + 1];\n            cloneValue[this.state.selectedIndex + 1] = tmp;\n            this.setState({selectedIndex: this.state.selectedIndex +1});\n            this.onValueChanged(cloneValue);\n        }\n    }\n    \n    public render(): JSX.Element {\n        return (\n            <div className={styles.groupSort}>\n                <Label>{this.props.label}</Label>\n                <div>\n                <CommandButton className={styles.groupButton} onClick={this.moveUp.bind(this)}><i className='fa fa-caret-up'></i><span>Move Up</span></CommandButton>\n                <CommandButton className={styles.groupButton} onClick={this.moveDown.bind(this)}><i className='fa fa-caret-down'></i><span>Move Down</span></CommandButton>\n                {/* <button className={styles.groupButton} onClick={this.moveUp.bind(this)} label=\"Move Up\"/>\n                <button className={styles.groupButton} onClick={this.moveDown.bind(this)}><i className='fa fa-caret-down'></i><span>Move Down</span></button> */}\n                { this.state.currentValue.length > 0 &&\n                    this.state.currentValue.map((item, index) => {\n                        return (\n                        <div className={styles.groupListItem+(this.state.selectedIndex==index ? \" \"+styles.highlight : \"\")} key={\"group-\"+index} onClick={this.setSelectItem.bind(this, index)}><span>{item}</span></div>\n                        );\n                    }\n                )}\n                { this.state.errorMessage != null && this.state.errorMessage != '' && this.state.errorMessage != undefined ?\n                    <div><div aria-live='assertive' className='ms-u-screenReaderOnly' data-automation-id='error-message'>{  this.state.errorMessage }</div>\n                    <span>\n                        <p className='ms-TextField-errorMessage ms-u-slideDownIn20'>{ this.state.errorMessage }</p>\n                    </span>\n                    </div>\n                : ''}\n                </div>\n            </div>\n        );\n    }\n}"],"sourceRoot":"../../../../../src"}